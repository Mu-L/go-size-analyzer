version: '3'

env:
  GOARCH: amd64

tasks:
  build_windows:
    cmds:
      - go build -o test_windows_amd64.exe
    env:
      GOOS: windows

  build_linux:
    cmds:
      - go build -o test_linux_amd64
    env:
      GOOS: linux

  build_mac:
    cmds:
      - go build -o test_mac_amd64
    env:
      GOOS: darwin

  build_windows_strip:
    cmds:
      - go build -ldflags "-s -w" -o test_windows_amd64_strip.exe
    env:
      GOOS: windows

  build_linux_strip:
    cmds:
      - go build -ldflags "-s -w" -o test_linux_amd64_strip
    env:
      GOOS: linux

  build_mac_strip:
    cmds:
      - go build -ldflags "-s -w" -o test_mac_amd64_strip
    env:
      GOOS: darwin

  default:
    deps:
      - build_windows
      - build_linux
      - build_mac
      - build_windows_strip
      - build_linux_strip
      - build_mac_strip